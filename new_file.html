<!DOCTYPE html>
<html>

  <head>
    <meta charset="UTF-8">
    <title></title>
  </head>

  <body>

    <h2>留言</h2>
    <ol class="messageList">

    </ol>
    <form id="xxx">
      <label for="name">姓名：</label>
      <input type="text" name="name" id="name" />
      <label for="content">内容：</label>
      <input type="text" name="content" id="content" />
      <input type="submit" value="提交" />
    </form>
    <script src="//cdn1.lncld.net/static/js/3.5.0/av-min.js"></script>
    <script type="text/javascript">
      var APP_ID = 'tjLK1owHL4N1lFIArnImnrjN-gzGzoHsz';
      var APP_KEY = '0pt05duTgpOfwrL2XI9RoS6L';
      AV.init({
        appId: APP_ID,
        appKey: APP_KEY
      });
      var query = new AV.Query('Message');
      var messageList = document.querySelector('.messageList')
      var li = document.createElement('li')
      query.find().then(function(Message) {
        let array = Message.map(function(item) {
          return item.attributes
        })
        array.forEach(function(item) {
          let li = document.createElement('li')
          li.innerText = item.name + ':' + item.content
          messageList.appendChild(li)
        })
      }, function(error) {
        // 异常处理
      });
      xxx.addEventListener('submit', function(e) {
        e.preventDefault()
        var TestObject = AV.Object.extend('Message');
        var testObject = new TestObject();
        var content = xxx.querySelector('input[name=content]').value
        var name = xxx.querySelector('input[name=name]').value
        let li = document.createElement('li')
        li.innerText = name + ":" + content
        messageList.appendChild(li)
        testObject.save({
          'name': name,
          'content': content
        })
      })
    </script>
  </body>

</html>